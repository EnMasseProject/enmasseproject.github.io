<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Installation and configuration</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://enmasse.io/documentation/0.15.2/service_admin/">
  <link rel="alternate" type="application/rss+xml" title="EnMasse - Messaging as a Service" href="/feed.xml">
  
  
</head>


  <body>
    <div id="rhbar" style="height:40px;background-color: #202020">
        <a class="rhd-logo" href="http://developers.redhat.com" style="float: right;background-image: url(http://static.jboss.org/images/rhbar/rhd_reverse.png);background-repeat: no-repeat;height: 40px;width: 136px;"></a>
        <a class="rhlogo" href="http://www.redhat.com/" style="float: right;background-image: url(http://static.jboss.org/images/rhbar/redhatlogo_reverse.png);background-repeat: no-repeat;height: 40px;width: 85px;"></a>
    </div>


    <div align="center">
    <br />
    <img alt="EnMasse"
    src="https://raw.githubusercontent.com/EnMasseProject/enmasse/master/documentation/images/logo/enmasse_logo.png" height="30%" width="30%" />
</div>
<br />
<br />
<center>
<header align="center" style="align: center;">
  <nav>
    
    

<a href="/" title="Go to Overview">Overview</a> 

 |


<a href="/documentation" title="Go to Documentation">Documentation</a> 

 |


<a href="https://github.com/EnMasseProject/enmasse/releases/" title="Go to Downloads">Downloads</a> 

 |


<a href="/contributing" title="Go to Contributing">Contributing</a> 




  </nav>
</header>
</center>



    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <h2> Documentation for EnMasse 0.15.2 </h2>
        <header align="left">
  <nav>
    
    
  <a href="/documentation/0.15.2/getting_started" title="Go to Getting Started">Getting Started</a><br />

  <a href="/documentation/0.15.2/service_admin" title="Go to Installation and configuration">Installation and configuration</a><br />

  <a href="/documentation/0.15.2/tenant" title="Go to Managing address spaces and addresses">Managing address spaces and addresses</a><br />

  <a href="/documentation/0.15.2/messaging_app_developer" title="Go to Connecting applications to EnMasse">Connecting applications to EnMasse</a><br />


  </nav>
</header>

        <br />
        <h3> Installation and configuration </h3>
        <br />
        <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel2">
<li><a href="#installing-openshift">1. Installing EnMasse on OpenShift</a>
<ul class="sectlevel3">
<li><a href="#prerequisites-openshift">1.1. Prerequisites</a>
<ul class="sectlevel4">
<li><a href="#deploying_authentication_services">Deploying authentication services</a></li>
<li><a href="#deploying_enmasse">Deploying EnMasse</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#installing-openshift">2. Installing EnMasse on Kubernetes</a>
<ul class="sectlevel3">
<li><a href="#prerequisites-openshift">2.1. Prerequisites</a>
<ul class="sectlevel4">
<li><a href="#deploying_authentication_services_2">Deploying authentication services</a></li>
<li><a href="#deploying_enmasse_2">Deploying EnMasse</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="installing-openshift">1. Installing EnMasse on OpenShift</h3>
<div class="sect3">
<h4 id="prerequisites-openshift">1.1. Prerequisites</h4>
<div class="paragraph">
<p>To install EnMasse, you need to have the OpenShift client tools. You can download the OpenShift
Origin client from <a href="https://github.com/openshift/origin/releases">OpenShift Origin</a>. EnMasse has
been tested to work with the latest stable release of the OpenShift Origin Client.</p>
</div>
<div class="paragraph">
<p>If you do not have an OpenShift cluster available, see
<a href="https://github.com/minishift/minishift">minishift</a> for an example of how to run a local instance of OpenShift
on your machine.</p>
</div>
<div class="paragraph">
<p>You also need a way to generate certificates. This guide uses <a href="https://www.openssl.org/">OpenSSL</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download one of the releases from <a href="https://github.com/EnMasseProject/enmasse/releases" class="bare">https://github.com/EnMasseProject/enmasse/releases</a> and unpack it.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To simplify deployment, have a look at the <code>deploy-openshift.sh</code> script which should work on Linux
and Mac. You can invoke the deployment script with <code>-h</code> to view a list of options.</p>
</div>
<div class="paragraph">
<p>This guide will walk through the manual deployment procedure and should work on any platform
supporting the OpenShift client.</p>
</div>
<div class="sect4">
<h5 id="deploying_authentication_services">Deploying authentication services</h5>
<div class="paragraph">
<p>EnMasse require at least 1 authentication service to be deployed. The authentication service
can either be none (allow all), standard (keycloak) or external (not managed by enmasse).</p>
</div>
<div class="sect5">
<h6 id="deploying_the_none_authentication_service">Deploying the none authentication service</h6>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a certificate to use for the none authentication service. For testing purposes, you can create a self-signed certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">mkdir -p none-authservice-cert
openssl req -new -x509 -batch -nodes -days 11000 -subj "/O=io.enmasse/CN=none-authservice.enmasse.svc.cluster.local" -out none-authservice-cert/tls.crt -keyout none-authservice-cert/tls.key</pre>
</div>
</div>
</li>
<li>
<p>Create secret with the none authentication service certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc create secret tls none-authservice-cert --cert=none-authservice-cert/tls.crt --key=none-authservice-cert/tls.key -n enmasse</pre>
</div>
</div>
</li>
<li>
<p>Create the none authentication service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc process -f ./openshift/addons/none-authservice.yaml | oc create -n enmasse -f -</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="deploying_the_standard_authentication_service">Deploying the standard authentication service</h6>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a certificate to use for the standard authentication service. For testing purposes, you can create a self-signed certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">mkdir -p standard-authservice-cert
openssl req -new -x509 -batch -nodes -days 11000 -subj "/O=io.enmasse/CN=standard-authservice.enmasse.svc.cluster.local" -out standard-authservice-cert/tls.crt -keyout standard-authservice-cert/tls.key</pre>
</div>
</div>
</li>
<li>
<p>Create secret with the standard authentication service certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc create secret tls standard-authservice-cert --cert=standard-authservice-cert/tls.crt --key=standard-authservice-cert/tls.key -n enmasse</pre>
</div>
</div>
</li>
<li>
<p>Create secret with keycloak admin credentials. Choose password wisely as this user will have complete access over authentication and authorization policies:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc create -n enmasse secret generic keycloak-credentials --from-literal=admin.username=admin --from-literal=admin.password=myrandompassword</pre>
</div>
</div>
</li>
<li>
<p>Create the standard authentication service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc process -f ./openshift/addons/standard-authservice.yaml | oc create -n enmasse -f -</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="deploying_enmasse">Deploying EnMasse</h5>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create namespace:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc new-project enmasse</pre>
</div>
</div>
</li>
<li>
<p>Create service account for the EnMasse address controller:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc create sa enmasse-service-account -n enmasse</pre>
</div>
</div>
</li>
<li>
<p>Create cluster-wide roles used by the <code>enmasse-service-account</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc login -u system:admin
oc create -f ./openshift/cluster-roles.yaml</pre>
</div>
</div>
</li>
<li>
<p>Grant cluster-admin privileges to service account:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc login -u system:admin
oc adm policy add-cluster-role-to-user enmasse-namespace-admin system:serviceaccount:enmasse:enmasse-service-account</pre>
</div>
</div>
</li>
<li>
<p>Create a certificate to use for the address controller. For testing purposes, you can create a self-signed certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">mkdir -p address-controller-cert/
openssl req -new -x509 -batch -nodes -days 11000 -subj "/O=io.enmasse/CN=address-controller.enmasse.svc.cluster.local" -out address-controller-cert/tls.crt -keyout address-controller-cert/tls.key</pre>
</div>
</div>
</li>
<li>
<p>Create secret with address-controller certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc create -n enmasse secret tls address-controller-cert --cert=address-controller-cert/tls.crt --key=address-controller-cert/tls.key</pre>
</div>
</div>
</li>
<li>
<p>Deploy address-controller:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc process -f ./openshift/enmasse.yaml ENABLE_RBAC=true ADDRESS_CONTROLLER_CERT_SECRET=address-controller-cert | oc create -n enmasse -f -</pre>
</div>
</div>
<div class="paragraph">
<p>The deployments required for running EnMasse are now created.</p>
</div>
</li>
<li>
<p>EnMasse will be up and running once all pods in the 'enmasse' namespace are in the <code>Running</code> state:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">oc get pods -n enmasse</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installing-openshift">2. Installing EnMasse on Kubernetes</h3>
<div class="sect3">
<h4 id="prerequisites-openshift">2.1. Prerequisites</h4>
<div class="paragraph">
<p>To install EnMasse, you need to have the OpenShift client tools. You can download the OpenShift
Origin client from <a href="https://github.com/openshift/origin/releases">OpenShift Origin</a>. EnMasse has
been tested to work with the latest stable release of the OpenShift Origin Client.</p>
</div>
<div class="paragraph">
<p>If you do not have an OpenShift cluster available, see
<a href="https://github.com/minishift/minishift">minishift</a> for an example of how to run a local instance of OpenShift
on your machine.</p>
</div>
<div class="paragraph">
<p>You also need a way to generate certificates. This guide uses <a href="https://www.openssl.org/">OpenSSL</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download one of the releases from <a href="https://github.com/EnMasseProject/enmasse/releases" class="bare">https://github.com/EnMasseProject/enmasse/releases</a> and unpack it.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To simplify deployment, have a look at the <code>deploy-kubernetes.sh</code> script which should work on Linux
and Mac. You can invoke the deployment script with <code>-h</code> to view a list of options.</p>
</div>
<div class="paragraph">
<p>This guide will walk through the manual deployment procedure and should work on any platform
supporting the <code>kubectl</code> command line client.</p>
</div>
<div class="sect4">
<h5 id="deploying_authentication_services_2">Deploying authentication services</h5>
<div class="paragraph">
<p>EnMasse require at least 1 authentication service to be deployed. The authentication service
can either be none (allow all), standard (keycloak) or external (not managed by enmasse).</p>
</div>
<div class="sect5">
<h6 id="deploying_the_none_authentication_service_2">Deploying the none authentication service</h6>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a certificate to use for the none authentication service. For testing purposes, you can create a self-signed certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">mkdir -p none-authservice-cert
openssl req -new -x509 -batch -nodes -days 11000 -subj "/O=io.enmasse/CN=none-authservice.enmasse.svc.cluster.local" -out none-authservice-cert/tls.crt -keyout none-authservice-cert/tls.key</pre>
</div>
</div>
</li>
<li>
<p>Create secret with the none authentication service certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">kubectl create secret tls none-authservice-cert --cert=none-authservice-cert/tls.crt --key=none-authservice-cert/tls.key -n enmasse</pre>
</div>
</div>
</li>
<li>
<p>Create the none authentication service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">kubectl apply -f ./kubernetes/addons/none-authservice.yaml</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="deploying_the_standard_authentication_service_2">Deploying the standard authentication service</h6>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a certificate to use for the standard authentication service. For testing purposes, you can create a self-signed certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">mkdir -p standard-authservice-cert
openssl req -new -x509 -batch -nodes -days 11000 -subj "/O=io.enmasse/CN=standard-authservice.enmasse.svc.cluster.local" -out standard-authservice-cert/tls.crt -keyout standard-authservice-cert/tls.key</pre>
</div>
</div>
</li>
<li>
<p>Create secret with the standard authentication service certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">kubectl create -n enmasse secret tls standard-authservice-cert --cert=standard-authservice-cert/tls.crt --key=standard-authservice-cert/tls.key -n enmasse</pre>
</div>
</div>
</li>
<li>
<p>Create secret with keycloak admin credentials. Choose password wisely as this user will have complete access over authentication and authorization policies:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">kubectl create -n enmasse secret generic keycloak-credentials --from-literal=admin.username=admin --from-literal=admin.password=myrandompassword</pre>
</div>
</div>
</li>
<li>
<p>Create the standard authentication service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">kubectl apply -f ./kubernetes/addons/standard-authservice.yaml</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="deploying_enmasse_2">Deploying EnMasse</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create enmasse namespace:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">kubectl create namespace enmasse</pre>
</div>
</div>
</li>
<li>
<p>Create service account for the EnMasse address controller:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">kubectl create sa enmasse-service-account -n enmasse</pre>
</div>
</div>
</li>
<li>
<p>Create a certificate to use for the address controller. For testing purposes, you can create a self-signed certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">mkdir -p address-controller-cert/
openssl req -new -x509 -batch -nodes -days 11000 -subj "/O=io.enmasse/CN=address-controller.enmasse.svc.cluster.local" -out address-controller-cert/tls.crt -keyout address-controller-cert/tls.key</pre>
</div>
</div>
</li>
<li>
<p>Create secret with address-controller certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">kubectl -n enmasse secret tls address-controller-cert --cert=address-controller-cert/tls.crt --key=address-controller-cert/tls.key</pre>
</div>
</div>
</li>
<li>
<p>Deploy address-controller:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">kubectl apply -f ./kubernetes/enmasse.yaml</pre>
</div>
</div>
<div class="paragraph">
<p>The deployments required for running EnMasse are now created.</p>
</div>
</li>
<li>
<p>EnMasse will be up and running once all pods in the 'enmasse' namespace are in the <code>Running</code> state:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">kubectl get pods -n enmasse</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">EnMasse - Messaging as a Service</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              EnMasse - Messaging as a Service
            
            </li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>

    <div class="container" id="companyfooter">
      <div class="redhatlogo" style="text-align:center;">
          <div id="logospacer"></div>
          <a href="http://www.redhat.com/"><img alt="Red Hat" src="http://static.jboss.org/images/rhbar/redhatlogo.png"></a>
      </div>
    </div>
  </body>

</html>
